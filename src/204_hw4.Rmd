---
title: "ESM204 Homework 4 - Social Cost of Carbon"
author: "Nick Bissonnette, Taylor Lockmann, Laurel Wee"
date: "5/22/2021"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(here)
library(janitor)
```


## 1. Estimate a quadratic function relating damages to temperature

```{r}
damages_data <- read_csv(here("data", "damages.csv")) %>% clean_names()

warming_data <- read_csv(here("data", "warming.csv")) %>% clean_names()

#ggplot(data = damages_data, aes(x = warming, y = damages))+
  #geom_point()+
  #theme_bw()
```

```{r}
#Make the x variable exponential 
damages_data$warming2 <- damages_data$warming^2

quadratic_model <-lm(damages ~ warming + warming2, data = damages_data)

summary(quadratic_model)
```

```{r}
# Name coefficients we got from the above step

a <- quadratic_model$coefficients[[3]]
b <- quadratic_model$coefficients[[2]]

#Write quadratic function using a and b
quadratic_function <- function(x) a*x^2 + b*x

#plot(quadratic_function)

ggplot(data = damages_data, aes(x = warming, y = damages))+
  stat_function(fun = quadratic_function)+
  geom_point()+
  theme_bw()
```

## 2. Damages under baseline climate and pulse

### a) Damages over time without pulse

```{r}
# Use the damages function to create a new column for the warming data set

warming_data$damage_baseline <- quadratic_function(warming_data$warming_baseline)

ggplot(data = warming_data, aes(x = year, y = damage_baseline))+
  geom_point()+
  theme_bw()
```

### b) Damages over time with pulse
```{r}
# Use damages function to create a new column for warming data set
warming_data$damage_pulse <- quadratic_function(warming_data$warming_pulse)

ggplot(data = warming_data, aes(x = year, y = damage_pulse))+
  geom_point()+
  theme_bw()
```

### c) Difference in damages over time that arises from the pulse
```{r}
warming_data$damage_difference <-(warming_data$damage_pulse - warming_data$damage_baseline) 

ggplot(data = warming_data, aes(x = year, y = damage_difference))+
  geom_point()+
  theme_bw()
```

### d) difference in damages over time per ton of CO2

```{r}
warming_data$damage_diff_per_ton <-(warming_data$damage_difference/ 3.5e+10) 

ggplot(data = warming_data, aes(x = year, y = damage_diff_per_ton))+
  geom_point()+
  theme_bw()
```

## 3. Social Cost of Carbon 

```{r}
# Write a function for the social cost of carbon (SCC) according to discount rate
scc <- function(r) warming_data$damage_diff_per_ton/((1+r)^warming_data$x1)

# Make new columns of different discount rates
warming_data$scc_1 <- scc(0.01)
warming_data$scc_2 <- scc(0.02)
warming_data$scc_3 <- scc(0.03)
warming_data$scc_4 <- scc(0.04)
warming_data$scc_5 <- scc(0.05)

ggplot(data = warming_data, aes(x = year))+
  geom_line(data = warming_data, aes(x = year, y = scc_1))+
  geom_line(data = warming_data, aes(x = year, y = scc_2))+
  geom_line(data = warming_data, aes(x = year, y = scc_3))+
  geom_line(data = warming_data, aes(x = year, y = scc_4))+
  geom_line(data = warming_data, aes(x = year, y = scc_5))+
  theme_bw()
```

